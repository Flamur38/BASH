#!/usr/bin/env bash
set -e

log() { echo "[neovim] $1"; }

log "Updating package index"
sudo apt update

log "Installing Neovim and dependencies"
sudo apt install -y \
  neovim \
  python3 python3-pip \
  nodejs npm \
  ripgrep fd-find \
  git curl \
  lua5.1 \
  cargo

# fd symlink (idempotent)
log "Ensuring fd symlink"
mkdir -p "$HOME/.local/bin"
ln -sf "$(command -v fdfind)" "$HOME/.local/bin/fd"

log "Installed Neovim version:"
nvim --version | head -n1

log "Syncing plugins (Lazy.nvim)"
nvim --headless "+Lazy! sync" +qa || true

log "Neovim setup complete"

# #!/usr/bin/env bash
#
# #!/usr/bin/env bash
#
# if [ -f /etc/apt/sources.list.d/spotify.list ]; then
#   sudo sed -i 's|^deb .*spotify.com.*|#&|' /etc/apt/sources.list.d/spotify.list
# fi
#
#
# sudo apt update
# sudo add-apt-repository ppa:neovim-ppa/unstable -y
# sudo apt update && sudo apt install -y \
#   neovim ninja-build gettext cmake unzip curl build-essential git \
#   lua5.1 liblua5.1-0-dev python3 python3-pip cargo \
#   ripgrep fd-find nodejs npm
#
# # Link fd-find as fd
# mkdir -p ~/.local/bin
# ln -sf "$(which fdfind)" ~/.local/bin/fd
#
# # Add ~/.local/bin to PATH (Zsh only, as requested)
# echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.zshrc
# export PATH="$HOME/.local/bin:$PATH"
#
#
# nvim --headless "+Lazy! sync" +qa
#
