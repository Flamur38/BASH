#!/usr/bin/env bash
set -e

echo "[python-tools] Installing Python CLI tools via pipx"

if ! command -v pipx >/dev/null 2>&1; then
    echo "[python-tools] Installing pipx"
    sudo apt install -y pipx
    pipx ensurepath
fi

install() {
    local name="$1"
    local src="$2"

    if pipx list | grep -q "$name"; then
        echo "[python-tools] $name already installed"
    else
        echo "[python-tools] Installing $name"
        pipx install "$src"
    fi
}

# ---- Detection / DFIR ----
install sigma-cli sigma-cli
install oletools oletools
install flare-floss flare-floss
install flare-capa flare-capa

# ---- AD / Blue Team ----
install certipy-ad git+https://github.com/ly4k/Certipy.git
install bloodhound-ce git+https://github.com/dirkjanm/BloodHound.py.git@bloodhound-ce
install ldapdomaindump ldapdomaindump

echo "[python-tools] DONE"
