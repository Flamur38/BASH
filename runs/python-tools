#!/usr/bin/env bash
set -e

# ----------------------------------------
# colors & logging
# ----------------------------------------
GREEN="\e[1;32m"
CYAN="\e[1;36m"
YELLOW="\e[1;33m"
RESET="\e[0m"

PREFIX="PYTHON"

section() {
  echo -e "\n${CYAN}[${PREFIX}]${RESET} ${CYAN}$1${RESET}"
}

log() {
  echo -e "  ${GREEN}â€¢${RESET} $1"
}

warn() {
  echo -e "  ${YELLOW}!${RESET} $1"
}

# ----------------------------------------
# start
# ----------------------------------------
section "Python CLI tools (pipx)"

# ----------------------------------------
# pipx bootstrap
# ----------------------------------------
if ! command -v pipx >/dev/null 2>&1; then
    warn "pipx not found"
    log "Installing pipx"
    sudo apt install -y pipx
    pipx ensurepath
else
    log "pipx already installed"
fi

# ----------------------------------------
# install helper
# ----------------------------------------
install() {
    local name="$1"
    local src="$2"

    if pipx list | grep -q "$name"; then
        log "$name already installed"
    else
        log "Installing $name"
        pipx install --include-deps "$src"
    fi
}

# ----------------------------------------
# Detection / DFIR
# ----------------------------------------
section "Detection / DFIR tools"

install sigma-cli sigma-cli
install oletools oletools
install flare-floss flare-floss
install flare-capa flare-capa
install pysigma pysigma
install impacket impacket

# ----------------------------------------
# AD / Blue Team
# ----------------------------------------
section "AD / Blue Team tools"

install certipy-ad git+https://github.com/ly4k/Certipy.git
install bloodhound-ce git+https://github.com/dirkjanm/BloodHound.py.git@bloodhound-ce
install ldapdomaindump ldapdomaindump

# ----------------------------------------
# done
# ----------------------------------------
section "Python tools installation completed"







# #!/usr/bin/env bash
# set -e
#
# echo "[python-tools] Installing Python CLI tools via pipx"
#
# if ! command -v pipx >/dev/null 2>&1; then
#     echo "[python-tools] Installing pipx"
#     sudo apt install -y pipx
#     pipx ensurepath
# fi
#
# install() {
#     local name="$1"
#     local src="$2"
#
#     if pipx list | grep -q "$name"; then
#         echo "[python-tools] $name already installed"
#     else
#         echo "[python-tools] Installing $name"
#         pipx install --include-deps "$src"
#     fi
# }
#
# # ---- Detection / DFIR ----
# install sigma-cli sigma-cli
# install oletools oletools
# install flare-floss flare-floss
# install flare-capa flare-capa
# install pysigma pysigma
# install impacket impacket
#
# # ---- AD / Blue Team ----
# install certipy-ad git+https://github.com/ly4k/Certipy.git
# install bloodhound-ce git+https://github.com/dirkjanm/BloodHound.py.git@bloodhound-ce
# install ldapdomaindump ldapdomaindump
#
# echo "[python-tools] DONE"
