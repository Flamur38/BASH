#!/usr/bin/env bash
set -e

cyan="\e[1;36m"

status() {
    echo -e "\n${cyan}[zsh]${reset} ${cyan}$1${reset}"
}

# 1. Install zsh
status "Installing zsh"
sudo apt install -y zsh

# 2. Set zsh as default shell (only if not already)
if [[ "$SHELL" != "$(which zsh)" ]]; then
    status "Setting zsh as default shell"
    sudo chsh -s "$(which zsh)" "$USER"
else
    status "zsh already default shell"
fi

# 3. Install Oh My Zsh (non-interactive, idempotent)
if [[ ! -d "$HOME/.oh-my-zsh" ]]; then
    status "Installing Oh My Zsh"
    RUNZSH=no CHSH=no KEEP_ZSHRC=yes \
        sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
else
    status "Oh My Zsh already installed"
fi

status "Zsh setup complete"

